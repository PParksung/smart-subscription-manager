<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스마트 구독 관리 - Smart Subscription Manager</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body style="margin: 0; padding: 0; background-color: #f8f9fa;">
    <!-- 헤더 - E2BS 스타일 참고 (항상 흰색 배경, 고정 위치) -->
    <header class="header" id="mainHeader">
        <div class="container">
            <div class="logo">
                <i class="fas fa-credit-card"></i>
                <h1>스마트 구독 관리</h1>
            </div>
            <nav class="nav">
                <a href="/dashboard" class="nav-link active">대시보드</a>
                <a href="/subscriptions" class="nav-link">구독 목록</a>
                <a href="/calendar" class="nav-link">결제 일정</a>
                <a href="/analytics" class="nav-link">분석</a>
                <a href="/news" class="nav-link">뉴스</a>
            </nav>
            <div class="user-menu" id="userMenuContainer">
                <button class="btn btn-outline" id="loginBtn" onclick="authManager.showLoginModal()">로그인</button>
                <button class="btn btn-primary" id="signupBtn" onclick="authManager.showSignupModal()">회원가입</button>
            </div>
        </div>
    </header>

    <!-- 로그인 화면 -->
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <i class="fas fa-credit-card"></i>
                <h1>스마트 구독 관리</h1>
                <p>구독 서비스를 체계적으로 관리하세요</p>
            </div>
            <div class="login-actions">
                <button class="btn btn-primary btn-large" id="loginBtn" onclick="authManager.showLoginModal()">
                    <i class="fas fa-sign-in-alt"></i>
                    로그인
                </button>
                <button class="btn btn-outline btn-large" id="signupBtn" onclick="authManager.showSignupModal()">
                    <i class="fas fa-user-plus"></i>
                    회원가입
                </button>
            </div>
            <div class="login-features">
                <h3>주요 기능</h3>
                <ul>
                    <li><i class="fas fa-chart-line"></i> 실시간 구독 지출 분석 및 통계</li>
                    <li><i class="fas fa-calendar-check"></i> 결제 예정일 사전 알림으로 불필요한 지출 방지</li>
                    <li><i class="fas fa-grip-vertical"></i> 드래그 앤 드롭으로 간편한 구독 순서 관리</li>
                    <li><i class="fas fa-dollar-sign"></i> 환율 정보 연동으로 해외 구독 비용 자동 계산</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 메인 콘텐츠 -->
    <main class="main">
        <!-- 대시보드 섹션 -->
        <section id="dashboard" class="section active">
            <div class="container">
                <div class="dashboard-header">
                    <h2>구독 현황 대시보드</h2>
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-list"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalSubscriptions">0</h3>
                                <p>활성 구독</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-won-sign"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="monthlyTotal">₩0</h3>
                                <p>월간 총 지출</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="upcomingPayments">0</h3>
                                <p>다가오는 결제</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 구독 목록 미리보기 -->
                <div class="subscription-preview">
                    <h3>최근 구독 내역</h3>
                    <div class="subscription-list" id="recentSubscriptions">
                        <!-- 구독 항목들이 여기에 동적으로 추가됩니다 -->
                    </div>
                </div>

                <!-- 빠른 액션 -->
                <div class="quick-actions">
                    <button class="btn btn-primary" id="addSubscriptionBtn">
                        <i class="fas fa-plus"></i>
                        구독 추가
                    </button>
                    <button class="btn btn-outline" id="refreshExchangeBtn">
                        <i class="fas fa-sync-alt"></i>
                        환율 새로고침
                    </button>
                </div>
            </div>
        </section>

        <!-- 구독 목록 섹션 -->
        <section id="subscriptions" class="section">
            <div class="container">
                <div class="section-header">
                    <h2>구독 목록</h2>
                    <div class="filter-controls">
                        <select id="categoryFilter">
                            <option value="">전체 카테고리</option>
                            <option value="entertainment">🎬 엔터테인먼트</option>
                            <option value="music">🎵 음악</option>
                            <option value="ai">🤖 AI 서비스</option>
                            <option value="social">📱 소셜 미디어</option>
                            <option value="productivity">⚡ 생산성 도구</option>
                            <option value="cloud">☁️ 클라우드</option>
                            <option value="education">🎓 교육 및 학습</option>
                            <option value="finance">💰 금융 및 투자</option>
                            <option value="news">📰 뉴스 및 미디어</option>
                            <option value="gaming">🎮 게임</option>
                            <option value="development">💻 개발 도구</option>
                            <option value="security">🔒 보안</option>
                            <option value="other">📦 기타</option>
                        </select>
                        <input type="text" id="searchInput" placeholder="구독 검색...">
                    </div>
                </div>
                <div class="drag-drop-hint" style="margin-bottom: 1rem; padding: 0.75rem; background: #f0f4ff; border-left: 4px solid #667eea; border-radius: 5px; color: #555;">
                    <i class="fas fa-info-circle"></i> 드래그 앤 드롭으로 구독 순서를 변경할 수 있습니다.
                </div>
                <div class="subscription-list" id="allSubscriptions">
                    <!-- 모든 구독 항목들이 여기에 표시됩니다 -->
                </div>
            </div>
        </section>

        <!-- 결제 일정 섹션 -->
        <section id="calendar" class="section">
            <div class="container">
                <h2>결제 일정</h2>
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button id="prevMonth" class="btn btn-outline" onclick="console.log('이전 달 버튼 클릭'); if(typeof calendarManager !== 'undefined') calendarManager.goToPreviousMonth();">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="month-year-selector">
                            <h3 id="currentMonth">2024년 1월</h3>
                            <div class="selector-controls">
                                <select id="yearSelect" class="year-select">
                                    <!-- 년도 옵션들이 동적으로 추가됩니다 -->
                                </select>
                                <select id="monthSelect" class="month-select">
                                    <option value="0">1월</option>
                                    <option value="1">2월</option>
                                    <option value="2">3월</option>
                                    <option value="3">4월</option>
                                    <option value="4">5월</option>
                                    <option value="5">6월</option>
                                    <option value="6">7월</option>
                                    <option value="7">8월</option>
                                    <option value="8">9월</option>
                                    <option value="9">10월</option>
                                    <option value="10">11월</option>
                                    <option value="11">12월</option>
                                </select>
                            </div>
                        </div>
                        <button id="nextMonth" class="btn btn-outline" onclick="console.log('다음 달 버튼 클릭'); if(typeof calendarManager !== 'undefined') calendarManager.goToNextMonth();">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar" id="paymentCalendar">
                        <!-- 달력이 여기에 동적으로 생성됩니다 -->
                    </div>
                </div>
            </div>
        </section>

        <!-- 분석 섹션 -->
        <section id="analytics" class="section">
            <div class="container">
                <h2>구독 분석</h2>
                <div class="analytics-content">
                    <div class="chart-container">
                        <h3>카테고리별 지출</h3>
                        <canvas id="categoryChart"></canvas>
                        <!-- HTML Graphics: Canvas 직접 사용 차트 -->
                        <canvas id="categoryChartCanvas" style="display: none; max-width: 100%; height: 300px;"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>월별 지출 추이</h3>
                            <div class="period-selector">
                                <select id="monthlyPeriodSelect">
                                    <option value="6">최근 6개월</option>
                                    <option value="12" selected>최근 12개월</option>
                                    <option value="24">최근 24개월</option>
                                </select>
                                <button class="btn btn-small btn-outline" id="toggleChartMode" onclick="toggleChartMode()">
                                    <i class="fas fa-exchange-alt"></i> 차트 모드 전환
                                </button>
                            </div>
                        </div>
                        <canvas id="monthlyChart"></canvas>
                        <!-- HTML Graphics: Canvas 직접 사용 차트 -->
                        <canvas id="monthlyChartCanvas" style="display: none; max-width: 100%; height: 300px;"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- 뉴스 섹션 -->
        <section id="news" class="section">
            <div class="container">
                <div class="news-header">
                    <h2>구독 카테고리 뉴스</h2>
                    <button class="btn btn-outline" id="refreshNewsBtn">
                        <i class="fas fa-sync-alt"></i>
                        새로고침
                    </button>
                </div>
                <div class="news-category-filter">
                    <button class="category-filter-btn active" data-category="all">전체</button>
                    <button class="category-filter-btn" data-category="entertainment">엔터테인먼트</button>
                    <button class="category-filter-btn" data-category="music">음악</button>
                    <button class="category-filter-btn" data-category="productivity">생산성</button>
                    <button class="category-filter-btn" data-category="cloud">클라우드</button>
                    <button class="category-filter-btn" data-category="ai">AI</button>
                    <button class="category-filter-btn" data-category="development">개발</button>
                </div>
                <div class="news-content" id="newsContent">
                    <div class="news-loading">뉴스를 불러오는 중...</div>
                </div>
            </div>
        </section>
    </main>

    <!-- 푸터 - E2BS 스타일 참고 -->
    <footer class="footer-area" style="background: #f8f9fa; padding: 3rem 0; margin-top: 4rem;">
        <div class="container">
            <div class="row" style="display: flex; flex-wrap: wrap; gap: 2rem;">
                <div style="flex: 1; min-width: 200px;">
                    <h4 style="margin-bottom: 1rem; color: #222;">바로가기</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.5rem;"><a href="#dashboard" style="color: #777; text-decoration: none;">대시보드</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#subscriptions" style="color: #777; text-decoration: none;">구독 목록</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#calendar" style="color: #777; text-decoration: none;">결제 일정</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="#analytics" style="color: #777; text-decoration: none;">분석</a></li>
                    </ul>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <h4 style="margin-bottom: 1rem; color: #222;">주요 기능</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 0.5rem; color: #777;">구독 현황 통합 관리</li>
                        <li style="margin-bottom: 0.5rem; color: #777;">결제 일정 알림</li>
                        <li style="margin-bottom: 0.5rem; color: #777;">지출 분석 및 리포트</li>
                        <li style="margin-bottom: 0.5rem; color: #777;">드래그 앤 드롭 정렬</li>
                    </ul>
                </div>
            </div>
        </div>
        <div style="background: #222; color: white; padding: 1rem 0; margin-top: 2rem; text-align: center;">
            <div class="container">
                <p style="margin: 0; color: #999;">
                    Copyright &copy; <script>document.write(new Date().getFullYear());</script>
                    스마트 구독 관리 시스템 | 학번: 202102638 | 이름: 박성민
                </p>
            </div>
        </div>
    </footer>

    <!-- 모달 -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- 스크립트 -->
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script src="js/subscription.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/canvas-chart.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/drag-drop.js"></script>
    <script src="js/news.js"></script>
    <script>
        // 차트 모드 전환 (Chart.js <-> Canvas 직접 사용)
        let useCanvasDirectly = false;
        
        function toggleChartMode() {
            useCanvasDirectly = !useCanvasDirectly;
            const chartJS = document.getElementById('categoryChart');
            const chartCanvas = document.getElementById('categoryChartCanvas');
            const monthlyChartJS = document.getElementById('monthlyChart');
            const monthlyChartCanvas = document.getElementById('monthlyChartCanvas');
            
            if (useCanvasDirectly) {
                chartJS.style.display = 'none';
                chartCanvas.style.display = 'block';
                monthlyChartJS.style.display = 'none';
                monthlyChartCanvas.style.display = 'block';
                
                // Canvas 직접 사용 차트 그리기
                if (typeof analyticsManager !== 'undefined') {
                    analyticsManager.updateCanvasCharts();
                }
            } else {
                chartJS.style.display = 'block';
                chartCanvas.style.display = 'none';
                monthlyChartJS.style.display = 'block';
                monthlyChartCanvas.style.display = 'none';
                
                // Chart.js 차트 업데이트
                if (typeof analyticsManager !== 'undefined') {
                    analyticsManager.updateAnalytics();
                }
            }
        }

        // 헤더 스크롤 효과 (E2BS 스타일 참고)
        window.addEventListener('scroll', () => {
            const header = document.getElementById('mainHeader');
            if (header) {
                if (window.scrollY > 50) {
                    header.classList.add('sticky-shadow');
                } else {
                    header.classList.remove('sticky-shadow');
                }
            }
        });
    </script>
</body>
</html>
